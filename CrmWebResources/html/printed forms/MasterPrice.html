<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://ppcrm1.crm4.dynamics.com//WebResources/sl_reports/css/pagedefenition.css" rel="stylesheet">
    <link href="https://ppcrm1.crm4.dynamics.com//WebResources/sl_reports/css/report_basic.css" rel="stylesheet">
    <title id="PageTitle">Master Price List</title>
    <meta>
</head>

<body style="max-width: 210mm; overflow-wrap: break-word;" onfocusout="parent.setEmailRange();">

    <div id="pageTemplate" class="page" style="height: 292mm;">
        <header>
            <div class="container-fluid">
                <div class="row">
                    <div class="col"> <img id="logo" src="/webresources/sl_/reports/images/logobbfwhite.png" class="logo"></div>
                    <div class="col">
                        <div class="project-name">
                            <div class="d-inline prefix-container">
                                <img src="/webresources/sl_/reports/images/logobbfwhite.png" class="prefix">
                            </div>
                            <div class="d-inline project-name-text"> master price-list</div>
                        </div>
                        <div style="float: none;"></div><br>
                        <span class="report-date"><span id="reportDate" class="reportDate"></span></span>
                    </div>
                </div>
            </div>
        </header>
        <div class="document-body" style="height: 214mm; overflow-y:hidden; margin-top: 0;"></div>
        <div class="emptyRow"></div>
        <footer>
            <div class="container-fluid">
                <div class="row report-info" style="background-color: #333; padding-bottom: 3mm; font-size: medium; color: #FFF;">
                    <div class="col-8"><span class="notification"></span></div>
                    <div class="col text-end"><span class="pagenumber"></span></div>
                </div>
                <div class="row footer-colored">
                    <div id="footerLeft" class="col-8">
                        <h5 id="websiteUrl" class="websiteUrl"></h5>
                        <p class="contact-data">
                            <span id="phoneLabel" class="phoneLabel"></span>:&nbsp;<span id="phone" class="phone"></span>&nbsp;<span id="faxLabel" class="faxLabel"></span>:&nbsp;<span id="fax" class="fax"></span>&nbsp;<span id="emailLabel" class="emailLabel"></span>:&nbsp;<span id="email" class="email"></span>
                        </p>
                        <p class="contact-data"><span id="address" class="address"></span></p>
                    </div>
                    <div id="footerRight" class="col-4 text-end">
                        <p class="contact-data">&nbsp;</p>
                        <p class="contact-data">&nbsp;</p>
                        <h5 id="tagline" class="tagline"></h5>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <div id="report-content" style="display: none;">
        <div class="container-fluid">
            <div class="row" style="height: 20mm; background-color: rgb(195, 187, 182); margin-bottom: 2mm;">
                <div class="col">
                    <div class="d-inline" style="font-size: 28pt; color: #000; font-family: 'Trakya', sans-serif; position: relative; left: 7mm; top: 2mm; font-weight: 700;"><span id="objectName" class="objectName"></span></div>
                </div>
            </div>
            <div class="row hero-wrapper">
                <div class="col"> <img class="img-fluid" id="preview" src="https://via.placeholder.com/317" alt="preview"> </div>
                <div class="col">
                    <p><span id="detailsLabel" class="detailsLabel"></span>:</p>
                    <p id="details" class="details"></p>
                </div>
                <div class="col">
                    <p><span id="majorBenefitsLabel" class="majorBenefitsLabel"></span>:</p>
                    <p id="majorBenefits" class="majorBenefits"></p>
                </div>
            </div>
            <div class="row">
                <div class="col report-maintable-container">
                    <table class="report-maintable">
                        <thead class="tableHeader">
                            <tr class="headerTitle">
                            </tr>
                            <tr class="headerUnit">
                            </tr>
                        </thead>
                        <tbody class="mainTable">
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </div>

    <div id="report-content-n" style="display: none;">
        <div class="container-fluid">
            <div class="row">
                <div class="col report-maintable-container">
                    <table class="report-maintable">
                        <thead class="tableHeader">
                            <tr class="headerTitle">
                            </tr>
                            <tr class="headerUnit">
                            </tr>
                        </thead>
                        <tbody class="mainTable">
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </div>

    <div id="report-title" style="display: none; ">
        <div class="container-fluid">
            <div class="row" style="margin-top: 80mm; margin-left: 10mm; background-color:#FFF;">
                <div class="col">
                    <img style="height: 22mm;" src="/webresources/sl_/reports/images/bbfblack.png">
                </div>
                <div class="row">
                    <div class="col">
                        <div class="d-inline" style="font-size: 28pt; color: #000; font-family: 'Trakya', sans-serif; font-weight: 700;">
                            <span>master price-list</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="d-inline" style="font-size: 12pt; color: #000; font-family: 'Trakya', sans-serif; ">
                        <span class="reportDate"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="report-group" style="display: none; ">
        <div class="container-fluid">
            <div class="row" style="margin-top: 56mm; background-color:#FFF;">
                <div class="col" style="height: 100mm; background-image: url(/WebResources/sl_/reports/images/dots.png); background-repeat: no-repeat; background-size: contain; padding-top: 43mm; background-position: center;">
                    <div class="d-inline" style="font-size: 28pt; color: #000; font-family: 'Trakya', sans-serif; font-weight: 700;">
                        <p style="text-align: center;" class="groupname"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script type="text/javascript">
        window.onload = windowLoad;
        var inputData = `{
                "metadata":{
                    "websiteUrl": "bbf.com",
                    "phoneLabel": "T",
                    "phone": "+357 25 315 300",
                    "faxLabel": "F",
                    "fax": "+357 25 315 301",
                    "emailLabel": "E",
                    "email": "info@bbf.com",
                    "address": "28 Ambelakion Street, Germasogeia 4046 Limassol, Cyprus P.O. Box 70649, 3801 Limassol",
                    "tagline": "Build. Better. Future.",
                    "withLogo": true,
                    "notification": "*The seller may change the prices without notification",
                    "mainTableColumns": [
                        {"name":"№","unit":false},
                        {"name":"IBP","unit":false},
                        {"name":"Floor","unit":false},
                        {"name":"Type","unit":false},
                        {"name":"Bedrooms","unit":false},
                        {"name":"Indoor area","unit":"sq. m."},
                        {"name":"Cov. veranda","unit":"sq. m."},
                        {"name":"Uncov. veranda","unit":"sq. m."},
                        {"name":"Roof terrace","unit":"sq. m."},
                        {"name":"Common area","unit":"sq. m."},
                        {"name":"Total area","unit":"sq. m."},
                        {"name":"Pool","unit":false},
                        {"name":"PRICE","unit":"€"},
                        {"name":"VAT","unit":false}
                    ]
                },
                "objectGroups":[
                    {
                        "groupName": "gated complexes near the sea",
                        "objects": [
                            {
                                "objectName": "sky tower",
                                "preview": "https://static.tildacdn.com/tild3830-3562-4865-b562-643637396531/view01_final.jpg",
                                "detailsLabel": "Details",
                                "details": [
                                    {"label":"City", "value": "Limassol"},
                                    {"label":"Area", "value": "Potamos Germasogeias"},
                                    {"label":"Completion", "value": "Under construction"},
                                    {"label":"Distance to sea", "value": "300 m"},
                                    {"label":"Prices from", "value": "800,000 €"},
                                    {"label":"Completion date", "value": "Jan 2021"}
                                ],
                                "majorBenefitsLabel": "Major benefits",
                                "majorBenefits": "<ul style='padding-left: 0;'><li>landmark architecture from the leading London bureau;</li> <li>the only high-rise condominium of Limassol with no noise from the coastal road;</li><li>breathtaking unobstructed sea views;</li><li>hotel-style facilities: concierge, SPA, outdoor pool, heated indoor pool, gym, tennis court, green area, and underground parking;</li></ul>",
                                "blocks": [
                                    {
                                        "blockName": "Block A",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    },
                                    {
                                        "blockName": "Block B",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    }
                                ]
                            },
                            {
                                "objectName": "sky tower2",
                                "preview": "https://static.tildacdn.com/tild3830-3562-4865-b562-643637396531/view01_final.jpg",
                                "detailsLabel": "Details",
                                "details": [
                                    {"label":"City", "value": "Limassol"},
                                    {"label":"Area", "value": "Potamos Germasogeias"},
                                    {"label":"Completion", "value": "Under construction"},
                                    {"label":"Distance to sea", "value": "300 m"},
                                    {"label":"Prices from", "value": "800,000 €"},
                                    {"label":"Completion date", "value": "Jan 2021"}
                                ],
                                "majorBenefitsLabel": "Major benefits",
                                "majorBenefits": "<ul style='padding-left: 0;'><li>landmark architecture from the leading London bureau;</li> <li>the only high-rise condominium of Limassol with no noise from the coastal road;</li><li>breathtaking unobstructed sea views;</li><li>hotel-style facilities: concierge, SPA, outdoor pool, heated indoor pool, gym, tennis court, green area, and underground parking;</li></ul>",
                                "blocks": [
                                    {
                                        "blockName": "Block A",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    },
                                    {
                                        "blockName": "Block B",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "groupName": "test no sea",
                        "objects": [
                            {
                                "objectName": "sky tower3",
                                "preview": "https://static.tildacdn.com/tild3830-3562-4865-b562-643637396531/view01_final.jpg",
                                "detailsLabel": "Details",
                                "details": [
                                    {"label":"City", "value": "Limassol"},
                                    {"label":"Area", "value": "Potamos Germasogeias"},
                                    {"label":"Completion", "value": "Under construction"},
                                    {"label":"Distance to sea", "value": "300 m"},
                                    {"label":"Prices from", "value": "800,000 €"},
                                    {"label":"Completion date", "value": "Jan 2021"}
                                ],
                                "majorBenefitsLabel": "Major benefits",
                                "majorBenefits": "<ul style='padding-left: 0;'><li>landmark architecture from the leading London bureau;</li> <li>the only high-rise condominium of Limassol with no noise from the coastal road;</li><li>breathtaking unobstructed sea views;</li><li>hotel-style facilities: concierge, SPA, outdoor pool, heated indoor pool, gym, tennis court, green area, and underground parking;</li></ul>",
                                "blocks": [
                                    {
                                        "blockName": "Block A",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    },
                                    {
                                        "blockName": "Block B",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    }
                                ]
                            },
                            {
                                "objectName": "sky tower4",
                                "preview": "https://static.tildacdn.com/tild3830-3562-4865-b562-643637396531/view01_final.jpg",
                                "detailsLabel": "Details",
                                "details": [
                                    {"label":"City", "value": "Limassol"},
                                    {"label":"Area", "value": "Potamos Germasogeias"},
                                    {"label":"Completion", "value": "Under construction"},
                                    {"label":"Distance to sea", "value": "300 m"},
                                    {"label":"Prices from", "value": "800,000 €"},
                                    {"label":"Completion date", "value": "Jan 2021"}
                                ],
                                "majorBenefitsLabel": "Major benefits",
                                "majorBenefits": "<ul style='padding-left: 0;'><li>landmark architecture from the leading London bureau;</li> <li>the only high-rise condominium of Limassol with no noise from the coastal road;</li><li>breathtaking unobstructed sea views;</li><li>hotel-style facilities: concierge, SPA, outdoor pool, heated indoor pool, gym, tennis court, green area, and underground parking;</li></ul>",
                                "blocks": [
                                    {
                                        "blockName": "Block A",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    },
                                    {
                                        "blockName": "Block B",
                                        "flatGroups": [
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "flats": [
                                                    {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        },
                                                        {
                                                            "flatNumber": "№101",
                                                            "ibp": "",
                                                            "floor": "1",
                                                            "type": "Appartment",
                                                            "bedrooms": "2",
                                                            "indoorArea": "75.6",
                                                            "covereddVeranda": "18.7",
                                                            "uncoveredVeranda": "0.0",
                                                            "roofTerrace": "0.0",
                                                            "commonArea": "10.5",
                                                            "totalArea": "104.7",
                                                            "pool": "Common",
                                                            "price": "Sold",
                                                            "vat": "Yes"
                                                        }
                                                    ]
                                                }

                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
            `;

        function windowLoad() {
            buildReport(inputData);
        }

        function addReportDate() {
            let date = new Date();
            let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            dateInputs = document.getElementsByClassName("reportDate");
            for (const elem in dateInputs) {
                dateInputs[elem].innerHTML = date.toLocaleDateString('en-US', options);
            }
        }

        function buildReport(inputData) {
            addPrintable();
            drawContent("report-title", 0, "", "hidden");
            inputObj = JSON.parse(inputData);
            processMetadata(inputObj, "");
            let objNumerator = 0;
            for (let i = 0; i < inputObj["objectGroups"].length; i++) {
                processGroup(inputObj, i)
                for (let j = 0; j < inputObj["objectGroups"][i]["objects"].length; j++) {
                    const obj = inputObj["objectGroups"][i]["objects"][j];
                    addPrintable(objNumerator);
                    drawContent("report-content", 0, objNumerator);
                    processObject(obj, objNumerator);
                    processMetadata(inputObj, objNumerator);
                    objNumerator++;
                }
            }

            for (let i = 0; i < JSON.parse(inputData).length; i++) {
                const obj = JSON.parse(inputData)[i];
                for (let key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        let elem = document.getElementById("printable" + i).querySelector("#" + key);
                        if (elem && key != "mainTable" && key != "metadata") {
                            if (elem.nodeName == "IMG") {
                                elem.src = obj[key];
                            }
                            else {
                                if (key != "details") {
                                    let elems = document.getElementById("printable" + i).getElementsByClassName(key);
                                    if (elems) {
                                        for (let j = 0; j < elems.length; j++) {
                                            elems[j].innerHTML = obj[key];
                                        }
                                    }
                                    else {
                                        elem.innerHTML = obj[key];
                                    }
                                }
                                else {
                                    for (const detail in obj[key]) {
                                        let detailBlock = document.getElementById("printable" + i).querySelector("#" + key);
                                        detailBlock.innerHTML += `${obj[key][detail]['label']}:&emsp;${obj[key][detail]['value']}<br>`;
                                    }
                                }
                            }
                        }
                        else {
                            if (key == "metadata") {
                                processMetadata(elem, obj, i);
                            }
                        }
                    }
                }
            }
            addReportDate()
            finishPages();
        }

        function processGroup(inputObject, groupNumber) {
            addPrintable("-group-" + groupNumber);
            let page = drawContent("report-group", groupNumber, "-group-" + groupNumber, "visible");
            page.getElementsByClassName("groupname")[0].innerHTML = inputObject["objectGroups"][groupNumber]["groupName"];
            processMetadata(inputObject, "-group-" + groupNumber);
        }

        function processObject(obj, page) {
            for (let key in obj) {
                if (obj.hasOwnProperty(key)) {
                    let elem = document.getElementById("printable" + page).querySelector("#" + key);
                    if (elem && key != "blocks") {
                        if (elem.nodeName == "IMG") {
                            elem.src = obj[key];
                        }
                        else {
                            if (key != "details") {
                                let elems = document.getElementById("printable" + page).getElementsByClassName(key);
                                if (elems) {
                                    for (let j = 0; j < elems.length; j++) {
                                        elems[j].innerHTML = obj[key];
                                    }
                                }
                                else {
                                    elem.innerHTML = obj[key];
                                }
                            }
                            else {
                                for (const detail in obj[key]) {
                                    let detailBlock = document.getElementById("printable" + page).querySelector("#" + key);
                                    detailBlock.innerHTML += `${obj[key][detail]['label']}:&emsp;${obj[key][detail]['value']}<br>`;
                                }
                            }
                        }
                    }
                }
            }
            processMainTable(obj, page);
        }

        function processMainTable(obj, printable) {
            let page = 0;
            let insertedRows = 0;
            for (const block in obj["blocks"]) {
                let elem = document.getElementById("printable" + printable).getElementsByClassName("mainTable")[page];
                if (obj["blocks"][block].blockName) {
                    let blockRow = document.createElement("tr");
                    let blockTd = document.createElement("td");
                    blockTd.colSpan = 999;
                    blockTd.innerHTML = obj["blocks"][block].blockName;
                    blockRow.appendChild(blockTd);
                    if ((page == 0 && insertedRows < 29) || (page > 0 && insertedRows < 48)) {
                        elem.appendChild(blockRow);
                        insertedRows++;
                    }
                    else {
                        page++;
                        insertedRows = 0;
                        drawContent("report-content-n", page);
                        elem = document.getElementById("printable" + printable).getElementsByClassName("mainTable")[page];
                        elem.appendChild(blockRow);
                        insertedRows++;
                    }
                }
                let floors = obj["blocks"][block].flatGroups;
                for (const floorNum in floors) {
                    elem = document.getElementById("printable" + printable).getElementsByClassName("mainTable")[page];
                    let floor = floors[floorNum]
                    for (const flat in floor["flats"]) {
                        elem = document.getElementById("printable" + printable).getElementsByClassName("mainTable")[page];
                        let flatRow = document.createElement("tr");
                        for (let key in floor["flats"][flat]) {
                            let flatTd = document.createElement("td");
                            flatTd.innerHTML = floor["flats"][flat][key];
                            flatRow.appendChild(flatTd);
                        }
                        if ((flat == floor.length - 1) && floor.length != 1) flatRow.classList.add("row-spacer");
                        if ((page == 0 && insertedRows < 29) || (page > 0 && insertedRows < 48)) {
                            elem.appendChild(flatRow);
                            insertedRows++;
                        }
                        else {
                            page++;
                            insertedRows = 0;
                            drawContent("report-content-n", page, printable);
                            elem = document.getElementById("printable" + printable).getElementsByClassName("mainTable")[page];
                            elem.appendChild(flatRow);
                            insertedRows++;
                        }
                    }
                }
            }
        }

        function addPrintable(projectId = "") {
            let printableDiv = document.createElement("div");
            printableDiv.id = "printable" + projectId;
            printableDiv.style.maxWidth = "210mm";
            printableDiv.style.pageBreakAfter = "always";
            document.getElementsByTagName("body")[0].appendChild(printableDiv);
        }

        function processMetadata(obj, printable) {
            if (obj["metadata"]) {
                const metadata = obj["metadata"];
                if (!metadata.withLogo) {
                    document.getElementById("printable" + printable).getElementById("logo").style.display = "none";
                    document.getElementById("printable" + printable).getElementById("footerLeft").style.display = "none";
                    document.getElementById("printable" + printable).getElementById("footerRight").style.display = "none";
                }
                if (metadata.mainTableColumns) {
                    for (const column in metadata.mainTableColumns) {
                        let columnElement = document.createElement("td");
                        columnElement.innerHTML = metadata.mainTableColumns[column].name;
                        if (metadata.mainTableColumns[column].unit) {
                            let unitElement = document.createElement("td");
                            unitElement.innerHTML = metadata.mainTableColumns[column].unit;
                            let units = document.getElementById("printable" + printable).getElementsByClassName("headerUnit");
                            [].forEach.call(units, function (item) {
                                item.appendChild(unitElement.cloneNode(true));
                            });
                        }
                        else {
                            columnElement.rowSpan = 2;
                        }
                        let cols = document.getElementById("printable" + printable).getElementsByClassName("headerTitle");
                        [].forEach.call(cols, function (item) {
                            item.appendChild(columnElement.cloneNode(true));
                        });
                    }
                }
                for (const record in metadata) {
                    let elems = document.getElementById("printable" + printable).getElementsByClassName(record);
                    if (elems) {
                        for (let j = 0; j < elems.length; j++) {
                            elems[j].innerHTML = metadata[record];
                        }
                    }

                }
            }
        }

        function drawContent(template = "report-content", pageNum = 0, projectId = "", showHeader = "visible") {
            let content = document.getElementById(template);
            let page = drawPage(pageNum, projectId, showHeader);
            let data = content.cloneNode(true);
            data.style.display = "block";
            data.style["overflow-y"] = "hidden";
            data.id = template + pageNum;
            page.getElementsByClassName("document-body")[0].appendChild(data);
            return page;
        }

        function drawPage(pageId, projectId = "", showHeader = "visible") {
            let page = document.getElementById("pageTemplate").cloneNode(true);
            page.style.display = "block";
            page.id = "page" + pageId;
            page.style.pageBreakAfter = "always"
            page.getElementsByTagName("header")[0].style.visibility = showHeader;
            document.getElementById("printable" + projectId).appendChild(page);
            return page;
        }

        function finishPage(height = 1127, projectId = "") {
            var previous = document.getElementById("printable" + projectId).lastChild;
            if (previous != null && previous.getElementsByClassName("emptyRow")) {
                if (previous.scrollHeight != height)
                    previous.getElementsByClassName("emptyRow")[0].style.height = (height - previous.scrollHeight) + "px";
            }
        }

        function finishPages(height = 1120) {
            var pages = document.getElementsByClassName("page");
            if (pages) {
                for (let j = 0; j < pages.length; j++) {
                    pages[j].getElementsByClassName("pagenumber")[0].innerHTML = "Page " + j + " of " + (pages.length - 1);
                }
            }
        }

    </script>


</body>
</html>